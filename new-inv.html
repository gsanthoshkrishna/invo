<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Inventory</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>

<select id="category" name="category">
    {% for category in categories %}
    <option value="{{ category[0] }}">{{ category[0] }}</option>
    {% endfor %}
</select>

<div id="fields"></div>
<form id="myForm"  method="POST">
    <div id="dynamicFields"></div>
    <input type="submit" value="Submit">
</form>
<script>
    $(document).ready(function() {
        $('#category').on('change', function() {
            var category_id = $(this).val();
            $.ajax({
                type: 'POST',
                url: '/get_fields',
                data: JSON.stringify({ category_id: category_id }),
                contentType: 'application/json',
                success: function(fields) {
                    $('#dynamicFields').empty();
                    fields.forEach(function(field) {
                        $('#dynamicFields').append('<label>'+ field +'</label><input type="text" placeholder="' + field + '">
');
                    });
                }
            });
        });

        // Trigger change event on page load
        $('#category').trigger('change');
        $('#myForm').submit(function(event) {
            event.preventDefault();
            var formData = $(this).serialize();
            $.ajax({
                type: 'POST',
                url: '/add-item-details',
                data: formData,
                success: function(response) {
                    console.log(response);
                }
            });
        });
    });
</script>

</body>
</html>

